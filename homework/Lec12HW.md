# 操作系统Lec12 HW

###### 张钰晖 计算机系计55班 2015011372 yuhui-zh15@mails.tsinghua.edu.cn

> 时间有限，抄一遍答案复习加深印象，也给期中期末留一些复习资料，麻烦您不用批改了，谢谢！

### 12.1 进程切换

1. 进程切换的可能时机有哪些？

   时间片用完、被高优先级进程抢先、进入等待状态、进程结束

2. 分析ucore的进程切换代码，说明ucore的进程切换触发时机和进程切换的判断时机都有哪些。

   schedule

   proc_run

   switch_to

3. ucore的进程控制块数据结构是如何组织的？主要字段分别表示什么？

   进程基本信息

   进程状态信息

   进程执行现场保存

   进程队列指针

### 12.2 进程创建

1. fork()的返回值是唯一的吗？父进程和子进程的返回值是不同的。请找到相应的赋值代码。

2. 新进程创建时的进程标识是如何设置的？请指明相关代码。

   get_pid();

3. 请通过fork()的例子中进程标识的赋值顺序说明进程的执行顺序。

4. 请在ucore启动时显示空闲进程（idleproc）和初始进程（initproc）的进程标识。

5. 请在ucore启动时显示空闲线程（idleproc）和初始进程(initproc)的进程控制块中的“pde_t *pgdir”的内容。它们是否一致？为什么？

### 12.3 进程加载

1. 加载进程后，新进程进入就绪状态，它开始执行时的第一条指令的位置，在elf中保存在什么地方？在加载后，保存在什么地方？
2. 第一个用户进程执行的代码在哪里？它是什么时候加载到内存中的？

### 12.4 进程等待与退出

1. 试分析wait()和exit()的结果放在什么地方？exit()是在什么时候放进去的？wait()在什么地方取到出的？

2. 试分析ucore操作系统内核是如何把子进程exit()的返回值传递给父进程wait()的？

3. 什么是僵尸进程和孤儿进程？

   https://piazza.com/class/i5j09fnsl7k5x0?cid=753

4. 试分析sleep()系统调用的实现。在什么地方设置的定时器？它对应的等待队列是哪个？它的唤醒操作在什么地方？

5. 通常的函数调用和函数返回都是一一对应的。有不是一一对应的例外情况？如果有，请举例说明。